CREATE TABLE COTACAO(
	IDCOTACAO INT NOT NULL AUTO_INCREMENT,
    VLCOTACAO DOUBLE DEFAULT NULL,
    DTCOTACAO DATETIME DEFAULT NULL,
    PRIMARY KEY (IDCOTACAO)
);


INSERT INTO `andes`.`cotacao` (`VLCOTACAO`, `DTCOTACAO`) VALUES ('5.00', '24/01/2007');
INSERT INTO `andes`.`cotacao` (`VLCOTACAO`, `DTCOTACAO`) VALUES ('5.50', '19/11/2006');

SELECT P.PEDIDOID, P.DATA_PEDIDO, P.VALOR_PEDIDO,
(P.VALOR_PEDIDO / C.VLCOTACAO) AS VALOR_EM_DOLARES
FROM PEDIDOS P, COTACAO C
WHERE P.DATA_PEDIDO = '2007-01-24' 
OR P.DATA_PEDIDO = '2006-11-19'
AND C.DTCOTACAO = P.DATA_PEDIDO
GROUP BY P.PEDIDOID;

SELECT P.PEDIDOID, P.DATA_PEDIDO, P.VALOR_PEDIDO,
(P.VALOR_PEDIDO / C.VLCOTACAO) AS VALOR_EM_DOLARES
FROM PEDIDOS P, COTACAO C
WHERE C.DTCOTACAO = P.DATA_PEDIDO
GROUP BY P.PEDIDOID;
-------------------
SELECT P.PEDIDOID, P.DATA_PEDIDO, P.VALOR_PEDIDO,
(P.VALOR_PEDIDO / C.VLCOTACAO) AS VALOR_EM_DOLARES
FROM PEDIDOS P, COTACAO C
WHERE C.DTCOTACAO = P.DATA_PEDIDO
GROUP BY P.PEDIDOID;